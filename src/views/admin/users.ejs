<div class="d-flex justify-content-between align-items-center mb-4">
  <h1 class="h3 mb-0 text-gray-800">Manage Users</h1>
</div>

<div class="card shadow-sm border-0">
  <div class="card-body p-0">
    <% if (!users || users.length===0) { %>
      <div class="p-4 text-center text-muted">
        <i class="fas fa-users fa-3x mb-3 text-secondary"></i>
        <p class="mb-0">No users found in the system.</p>
      </div>
      <% } else { %>
        <div class="table-responsive">
          <table class="table table-hover align-middle mb-0">
            <thead class="table-light">
              <tr>
                <th class="ps-4">Name</th>
                <th>Email</th>
                <th>Role</th>
                <th>Status</th>
                <th>Location</th>
                <th>Created</th>
                <th class="text-end pe-4">Actions</th>
              </tr>
            </thead>
            <tbody>
              <% users.forEach(u=> { %>
                <tr>
                  <td class="ps-4">
                    <div class="fw-bold">
                      <%= u.name %>
                    </div>
                  </td>
                  <td>
                    <%= u.email %>
                  </td>
                  <td>
                    <span class="badge rounded-pill <%= u.role === 'admin' ? 'bg-dark' : 'bg-primary' %>">
                      <%= u.role.toUpperCase() %>
                    </span>
                  </td>
                  <td>
                    <% if (u.isPublic) { %>
                      <span class="badge rounded-pill bg-success">Active</span>
                      <% } else { %>
                        <span class="badge rounded-pill bg-danger">Suspended</span>
                        <% } %>
                  </td>
                  <td>
                    <%= u.location || '-' %>
                  </td>
                  <td>
                    <%= new Date(u.createdAt).toLocaleDateString() %>
                  </td>
                  <td class="text-end pe-4">
                    <form method="POST" action="/admin/users/<%= u.id %>/toggle-suspend" class="d-inline-block">
                      <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                      <button type="submit"
                        class="btn btn-sm w-100 <%= u.isPublic ? 'btn-outline-warning' : 'btn-outline-success' %>"
                        <%=u.role==='admin' ? 'disabled' : '' %>>
                        <%= u.isPublic ? 'Suspend' : 'Activate' %>
                      </button>
                    </form>
                  </td>
                </tr>
                <% }) %>
            </tbody>
          </table>
        </div>
        <div class="p-3 border-top">
          <%- include('../partials/pagination') %>
        </div>
        <% } %>
  </div>
</div>