<div class="modal fade" id="tipModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header border-0">
        <h5 class="modal-title"><i class="fas fa-gift text-warning me-2"></i>Send Tip</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body text-center py-4">
        <div class="mb-3">
          <i class="fas fa-coins fa-3x text-warning mb-3"></i>
        </div>
        <p class="mb-2">You're about to tip <strong id="tipToUserName">this user</strong></p>
        <p class="text-muted small mb-0">You'll be redirected to a secure payment page.</p>
      </div>
      <div class="modal-footer border-0 justify-content-center">
        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
        <a href="#" id="tipPaymentLink" class="btn btn-success">
          <i class="fas fa-credit-card me-2"></i>Continue to Payment
        </a>
      </div>
    </div>
  </div>
</div>

<script>
  (function () {
    const modalEl = document.getElementById('tipModal');
    let bsModal;
    function ensure() { if (!bsModal) bsModal = new bootstrap.Modal(modalEl); }
    document.addEventListener('click', (e) => {
      const btn = e.target.closest('.js-tip');
      if (!btn) return;
      const uid = btn.getAttribute('data-user-id');
      const uname = btn.getAttribute('data-user-name') || 'User';
      document.getElementById('tipToUserName').textContent = uname;
      document.getElementById('tipPaymentLink').href = '/tips/send/' + uid;
      ensure();
      bsModal.show();
    });
  })();
</script>