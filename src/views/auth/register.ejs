<div class="d-flex align-items-center" style="animation: fadeIn 0.5s ease-out;">
  <div class="container-fluid">
    <div class="row g-0">
      <!-- Left Panel - Branding (Hidden on mobile) -->
      <div class="col-lg-5 d-none d-lg-flex bg-primary bg-gradient text-white p-5 position-relative overflow-hidden"
        style="animation: slideInLeft 0.6s ease-out;">
        <div class="position-absolute top-0 start-0 w-100 h-100 opacity-10"
          style="background: radial-gradient(circle, white 1px, transparent 1px); background-size: 50px 50px;"></div>
        <div class="position-relative z-1 d-flex flex-column justify-content-center"
          style="max-width: 450px; margin: auto;">
          <div class="mb-4" style="animation: float 3s ease-in-out infinite;">
            <i class="fas fa-user-plus display-1 opacity-75"></i>
          </div>
          <h1 class="display-4 fw-bold mb-3" style="animation: fadeInUp 0.6s ease-out 0.1s both;">Join SkillSwap MY
          </h1>
          <p class="fs-5 opacity-75 mb-5" style="animation: fadeInUp 0.6s ease-out 0.2s both;">Start your skill
            exchange journey today</p>

          <div class="d-flex flex-column gap-4">
            <div class="d-flex align-items-start gap-3" style="animation: fadeInUp 0.6s ease-out 0.3s both;">
              <i class="fas fa-graduation-cap fs-1 opacity-75 flex-shrink-0"></i>
              <div>
                <h5 class="fw-semibold mb-1">Learn & Teach</h5>
                <p class="mb-0 opacity-75">Share your skills and learn new ones from peers</p>
              </div>
            </div>
            <div class="d-flex align-items-start gap-3" style="animation: fadeInUp 0.6s ease-out 0.4s both;">
              <i class="fas fa-handshake fs-1 opacity-75 flex-shrink-0"></i>
              <div>
                <h5 class="fw-semibold mb-1">Build Connections</h5>
                <p class="mb-0 opacity-75">Network with like-minded learners and experts</p>
              </div>
            </div>
            <div class="d-flex align-items-start gap-3" style="animation: fadeInUp 0.6s ease-out 0.5s both;">
              <i class="fas fa-chart-line fs-1 opacity-75 flex-shrink-0"></i>
              <div>
                <h5 class="fw-semibold mb-1">Track Progress</h5>
                <p class="mb-0 opacity-75">Monitor your learning journey and achievements</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Right Panel - Register Form -->
      <div class="col-lg-7 bg-light d-flex align-items-center justify-content-center p-4"
        style="animation: slideInRight 0.6s ease-out;">
        <div class="w-100 bg-white rounded-3 shadow-sm p-4 p-lg-5"
          style="max-width: 600px; animation: scaleUp 0.5s ease-out 0.2s both;">
          <div class="text-center mb-4" style="animation: fadeInDown 0.4s ease-out 0.3s both;">
            <h2 class="h2 fw-bold mb-2">Create Account</h2>
            <p class="text-muted mb-0">Fill in your details to get started</p>
          </div>

          <div>
            <div>
              <form method="POST" action="/auth/register" id="registerForm">
                <input type="hidden" name="_csrf" value="<%= csrfToken %>">

                <div class="row">
                  <!-- Name Field -->
                  <div class="col-12 mb-3">
                    <label class="form-label fw-medium">Full Name</label>
                    <div class="input-group">
                      <span class="input-group-text bg-light">
                        <i class="fas fa-user text-muted"></i>
                      </span>
                      <input class="form-control" name="name" id="name" required placeholder="Enter your full name">
                    </div>
                  </div>

                  <!-- Email Field -->
                  <div class="col-12 mb-3">
                    <label class="form-label fw-medium">Email Address</label>
                    <div class="input-group">
                      <span class="input-group-text bg-light">
                        <i class="fas fa-envelope text-muted"></i>
                      </span>
                      <input class="form-control" type="email" name="email" id="email" required
                        placeholder="your.email@example.com">
                    </div>
                  </div>

                  <!-- Password Field -->
                  <div class="col-md-6 mb-3">
                    <label class="form-label fw-medium">Password</label>
                    <div class="input-group">
                      <span class="input-group-text bg-light">
                        <i class="fas fa-lock text-muted"></i>
                      </span>
                      <input class="form-control" type="password" name="password" id="password" required minlength="8"
                        placeholder="Create password">
                      <button class="btn btn-outline-secondary" type="button" id="togglePassword">
                        <i class="fas fa-eye" id="toggleIcon"></i>
                      </button>
                    </div>
                  </div>

                  <!-- Confirm Password Field -->
                  <div class="col-md-6 mb-3">
                    <label class="form-label fw-medium">Confirm Password</label>
                    <div class="input-group">
                      <span class="input-group-text bg-light">
                        <i class="fas fa-lock text-muted"></i>
                      </span>
                      <input class="form-control" type="password" name="confirmPassword" id="confirmPassword" required
                        minlength="8" placeholder="Confirm password">
                    </div>
                  </div>
                </div>

                <!-- Password Strength & Requirements in Compact Layout -->
                <div class="bg-light rounded-3 p-3 mb-3">
                  <div class="d-flex justify-content-between align-items-center mb-2">
                    <small class="text-muted fw-semibold">Password Strength:</small>
                    <small id="passwordStrengthText" class="fw-bold text-muted">Enter password</small>
                  </div>
                  <div class="progress mb-3" style="height: 6px;">
                    <div class="progress-bar" id="passwordStrengthBar" role="progressbar" style="width: 0%"
                      aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                  </div>

                  <div class="row row-cols-3 g-2">
                    <div class="col">
                      <div class="d-flex align-items-center gap-2" id="length-check">
                        <i class="fas fa-times text-danger"></i>
                        <small class="text-muted">8+ chars</small>
                      </div>
                    </div>
                    <div class="col">
                      <div class="d-flex align-items-center gap-2" id="uppercase-check">
                        <i class="fas fa-times text-danger"></i>
                        <small class="text-muted">Uppercase</small>
                      </div>
                    </div>
                    <div class="col">
                      <div class="d-flex align-items-center gap-2" id="lowercase-check">
                        <i class="fas fa-times text-danger"></i>
                        <small class="text-muted">Lowercase</small>
                      </div>
                    </div>
                    <div class="col">
                      <div class="d-flex align-items-center gap-2" id="number-check">
                        <i class="fas fa-times text-danger"></i>
                        <small class="text-muted">Number</small>
                      </div>
                    </div>
                    <div class="col">
                      <div class="d-flex align-items-center gap-2" id="special-check">
                        <i class="fas fa-times text-danger"></i>
                        <small class="text-muted">Special</small>
                      </div>
                    </div>
                    <div class="col">
                      <div class="d-flex align-items-center gap-2" id="match-check">
                        <i class="fas fa-times text-danger"></i>
                        <small class="text-muted">Match</small>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Submit Button -->
                <div class="d-grid mb-3">
                  <button class="btn btn-primary btn-lg" type="submit" id="submitBtn" disabled>
                    <span class="spinner-border spinner-border-sm me-2 d-none" id="submitSpinner" role="status"></span>
                    <i class="fas fa-user-plus me-2" id="submitIcon"></i>
                    <span id="submitText">Create Account</span>
                  </button>
                </div>


                <!-- Login Link -->
                <div class="text-center">
                  <p class="text-muted mb-0">
                    Already have an account?
                    <a href="/auth/login" class="text-primary text-decoration-none fw-semibold">
                      Sign in
                    </a>
                  </p>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const passwordInput = document.getElementById('password');
      const confirmPasswordInput = document.getElementById('confirmPassword');
      const strengthBar = document.getElementById('passwordStrengthBar');
      const strengthText = document.getElementById('passwordStrengthText');
      const submitBtn = document.getElementById('submitBtn');
      const submitWarning = document.getElementById('submitWarning');
      const submitSpinner = document.getElementById('submitSpinner');
      const submitIcon = document.getElementById('submitIcon');
      const submitText = document.getElementById('submitText');
      const togglePassword = document.getElementById('togglePassword');
      const toggleIcon = document.getElementById('toggleIcon');

      const checks = {
        length: document.getElementById('length-check'),
        uppercase: document.getElementById('uppercase-check'),
        lowercase: document.getElementById('lowercase-check'),
        number: document.getElementById('number-check'),
        special: document.getElementById('special-check'),
        match: document.getElementById('match-check')
      };

      // Password visibility toggle
      togglePassword.addEventListener('click', function () {
        const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
        passwordInput.setAttribute('type', type);
        confirmPasswordInput.setAttribute('type', type);
        toggleIcon.className = type === 'text' ? 'fas fa-eye-slash' : 'fas fa-eye';
      });

      function updateRequirementIcon(element, met) {
        const icon = element.querySelector('i');
        if (met) {
          icon.className = 'fas fa-check text-success';
          element.classList.add('met');
        } else {
          icon.className = 'fas fa-times text-danger';
          element.classList.remove('met');
        }
      }

      function checkPasswordStrength(password) {
        let score = 0;
        const criteria = {
          length: password.length >= 8,
          uppercase: /[A-Z]/.test(password),
          lowercase: /[a-z]/.test(password),
          number: /[0-9]/.test(password),
          special: /[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(password)
        };

        Object.keys(criteria).forEach(key => {
          updateRequirementIcon(checks[key], criteria[key]);
          if (criteria[key]) score++;
        });

        const percentage = (score / 5) * 100;
        let strength = 'Very Weak';
        let barClass = 'bg-danger';

        if (score === 5) {
          strength = 'Very Strong';
          barClass = 'bg-success';
        } else if (score === 4) {
          strength = 'Strong';
          barClass = 'bg-info';
        } else if (score === 3) {
          strength = 'Medium';
          barClass = 'bg-warning';
        } else if (score === 2) {
          strength = 'Weak';
          barClass = 'bg-warning';
        }

        strengthBar.style.width = percentage + '%';
        strengthBar.className = 'progress-bar ' + barClass;

        if (password.length === 0) {
          strengthText.textContent = 'Enter password';
          strengthText.className = 'fw-bold text-muted';
        } else {
          strengthText.textContent = strength;
          strengthText.className = 'fw-bold ' + barClass.replace('bg-', 'text-');
        }

        return score;
      }

      function checkPasswordMatch() {
        const password = passwordInput.value;
        const confirmPassword = confirmPasswordInput.value;

        if (confirmPassword.length === 0) {
          updateRequirementIcon(checks.match, false);
          return false;
        }

        const match = password === confirmPassword;
        updateRequirementIcon(checks.match, match);
        return match;
      }

      function updateSubmitButton() {
        const score = checkPasswordStrength(passwordInput.value);
        const passwordsMatch = checkPasswordMatch();
        const allFieldsFilled = document.getElementById('name').value.trim() &&
          document.getElementById('email').value.trim() &&
          passwordInput.value && confirmPasswordInput.value;

        if (score === 5 && passwordsMatch && allFieldsFilled) {
          submitBtn.disabled = false;
          submitBtn.className = 'btn btn-primary btn-lg';
          submitWarning.classList.add('d-none');
        } else {
          submitBtn.disabled = true;
          submitBtn.className = 'btn btn-outline-secondary btn-lg';
        }
      }

      passwordInput.addEventListener('input', updateSubmitButton);
      confirmPasswordInput.addEventListener('input', updateSubmitButton);
      document.getElementById('name').addEventListener('input', updateSubmitButton);
      document.getElementById('email').addEventListener('input', updateSubmitButton);

      document.getElementById('registerForm').addEventListener('submit', function (e) {
        const score = checkPasswordStrength(passwordInput.value);
        const passwordsMatch = checkPasswordMatch();

        if (score < 5 || !passwordsMatch) {
          e.preventDefault();
          Swal.fire({
            icon: 'warning',
            title: 'Password Requirements',
            text: 'Please meet all password requirements before registering.',
            confirmButtonColor: '#0d6efd'
          });
          return false;
        }

        submitBtn.disabled = true;
        submitSpinner.classList.remove('d-none');
        submitIcon.classList.add('d-none');
        submitText.textContent = 'Creating Account...';
      });
    });
  </script>

  <style>
    /* Minimal custom styles - mostly using Bootstrap 5 classes */
    @keyframes shake {

      0%,
      100% {
        transform: translateX(0);
      }

      25% {
        transform: translateX(-5px);
      }

      75% {
        transform: translateX(5px);
      }
    }

    /* Small enhancements for transitions */
    .btn {
      transition: all 0.2s ease-in-out;
    }

    .btn:hover:not(:disabled) {
      transform: translateY(-1px);
    }

    .input-group:focus-within {
      box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.15);
      border-radius: 0.375rem;
    }

    .progress-bar {
      transition: width 0.4s ease-in-out;
    }
  </style>

  <%- include('../partials/footer') %>